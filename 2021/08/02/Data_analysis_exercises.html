<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
     tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"] ],
       processEscapes: true
     }
   });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>


<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Data analysis and visualisation - exercises</h1><p class="post-meta post-meta-title">
    </p>

    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="error-bars">Error bars</h1>

<p>In [Python part two] you wrote a function to calculate the perimeter of a triangle and the associated standard error.</p>

<p>a) Use this function to plot the perimeter of an equilateral triangle as a function of side length. Use the following side lengths: 3.1cm, 6.7cm, 9.2cm, 12.4cm and assume you use. Think carefully about the type of plot: should it be a scatter plot or line plot?</p>

<p>b) Re-plot this data with attached error bars using the <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.errorbar.html"><code class="language-plaintext highlighter-rouge">matplotlib.pyplot.errorbar</code> function</a></p>

<h1 id="calculating-plancks-constant">Calculating Planck’s constant</h1>

<p><em>Adapted from Mark Newman’s book “Computational Physics, p. 124</em></p>

<p>When light is shone on the surface of a metal, the photons in the light can excite (transfer energy to) electrons in the metal and, sometimes, eject them from the surface into the free space above. The energy of the ejected electron can be calculated by measuring the minimum voltage $V$ that stops the electron moving.</p>

<p>We know that the energy of an ejected electron is equal to the energy of the photon that excited it minus the workfunction $\phi$ (which is the energy needed to remove it from the surface) and that the energy of a single photon is $hf$ where $h$ is Planck’s constant and $f$ is the frequency of light. Mathematically this can be expressed as:</p>

<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>V</mi><mo>=</mo><mi>h</mi><mi>f</mi><mo>−</mo><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">eV = hf - \phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span></span></span></span>,</p>

<p>where $e$ is the charge of the electron.</p>

<p>a) Read in the photoelectric measurement data from the file <a href="https://nu-cem.github.io/CompPhys/data/Planck.txt">Planck.txt</a>. The first column contains frequencies $f$ is hertz and the second column contains voltages $V$. Use this data to plot $V$ vs $f$. Think about the plot type - does a scatter plot of line plot make most sense?</p>

<p>The least-squares method is very commonly used for fitting a polynomial to a set of data. As it is so prevalent in physics and engineering, you are encouraged to watch <a href="https://www.youtube.com/watch?v=YwZYSTQs-Hk">this video</a> which give an intuitive and mathematical description of the method.</p>

<p>b) Fit a straight line (polynomial of degree one) to the data using the least-squares method implemented in <a href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.lstsq.html"><code class="language-plaintext highlighter-rouge">numpy.polyfit</code></a>. Overlay this line on your data points.</p>

<p>c) Using the gradient of the fitted line calculate a value for Planck’s constant. Compare this to values you can find online.</p>

<h1 id="line-fitting">Line fitting</h1>

<p>In the code below we calculate the velocity of a ball between times 0 and 10 and store it as a numpy array</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>
<span class="n">velocity_list</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">v_0</span> <span class="o">=</span> <span class="mi">0</span>
 
<span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">time</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">)):</span>
  <span class="n">velocity_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_0</span> <span class="o">+</span> <span class="n">g</span><span class="o">*</span><span class="n">time</span>
</code></pre></div></div>

<p>We can fit a polynomial to this data using the <code class="language-plaintext highlighter-rouge">numpy.polyfit</code> function. In this case, we know from looking at the equation that is is a first order polynomial (straight line).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fit</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span> <span class="n">velocity_list</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</code></pre></div></div>

<p>What is the gradient and intercept of the straight line fit? Does this make physical sense? 
Make a scatter plot of velocity vs time. Label the x-axis and y-axis (with units) and give the plot a title.</p>

<details>
  <summary>Show answer</summary>

  <p>The gradient is equal to the acceleration of the ball which is given by the gravitational constant $g$. The intercept is the starting velocity of the ball, which in this example is zero.</p>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">velocity_list</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Time (s)"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Velocity (m/s)"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Velocity of an object accelerated by gravity"</span><span class="p">)</span>
</code></pre></div>  </div>

</details>

<p>Use the polyval function to generate and plot velocities over the timeframe 30 to 100 seconds.</p>

<details>
  <summary>Show answer</summary>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">time_range</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_range</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="n">time_range</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Time (s)"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Velocity (m/s)"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Velocity of an object accelerated by gravity"</span><span class="p">)</span>
</code></pre></div>  </div>

</details>

<h1 id="error-bars-and-exponential-growth">Error bars and exponential growth</h1>

<p>This question is partly modelled on the a <a href="https://towardsdatascience.com/modeling-exponential-growth-49a2b6f22e1f">blog post</a>. There is also a nice
<a href="https://www.youtube.com/watch?v=Kas0tIxDvrg">3Blue1Brown video on exponential growth in the context of Covid</a>.</p>

<p>We have the following (hypothetical) data for the growth in Covid cases at a university over a two-week period</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">day</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
<span class="n">case_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">253</span><span class="p">,</span><span class="mi">512</span><span class="p">,</span><span class="mi">1025</span><span class="p">,</span><span class="mi">2049</span><span class="p">,</span><span class="mi">4090</span><span class="p">,</span><span class="mi">8191</span><span class="p">,</span><span class="mi">16387</span><span class="p">])</span>
</code></pre></div></div>

<p>Assuming that the growth is exponential, fit a straight line to the log of the case number data and predict the exponential growth factor.</p>

<details>
  <summary>Show answer</summary>

  <p>From scanning the blog post we can see that the growth factor is the base of the exponential.
Assuming the growth is exponential, to generate a straight-(ish) line we first need to take a logarithm of the case values data.
We can then fit a straight line to this to calculate the logarithm of the growth factor.</p>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">log_growth_factor</span><span class="p">,</span> <span class="n">log_starting_case_number</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">day</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">case_numbers</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="n">growth_factor</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_growth_factor</span><span class="p">)</span>
</code></pre></div>  </div>

</details>

<p>From inspecting the data, does the calculated growth factor make sense?</p>

<details>
  <summary>Show answer</summary>

  <p>The data roughly doubles each day. The calculated growth factor is 1.94, which is reassuringly close to 2.</p>

</details>

<hr />

<p>Back to <a href="https://nu-cem.github.io/CompPhys/2021/08/02/Data_analysis.html">Data analysis and visualisation</a>.</p>

<hr />

  </div><a class="u-url" href="/CompPhys/2021/08/02/Data_analysis_exercises.html" hidden></a>
</article>
